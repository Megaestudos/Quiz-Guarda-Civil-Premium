<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Painel Admin</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0b1220;
  --panel:#0f172a;
  --border:#1e293b;
  --primary:#2563eb;
  --primary-dark:#1e40af;
  --text:#e5e7eb;
  --radius:16px;
}
*{box-sizing:border-box;}
body{margin:0;font-family:Inter,sans-serif;background:radial-gradient(120% 100% at 20% 20%, rgba(37,99,235,.2), transparent 60%),radial-gradient(120% 100% at 80% 10%, rgba(16,185,129,.15), transparent 60%),var(--bg);color:var(--text);}
.header{display:flex;justify-content:space-between;align-items:center;padding:20px;}
h1{margin:0;font-size:24px;}
.button-logout{padding:8px 16px;border:none;border-radius:12px;background:linear-gradient(135deg,var(--primary),var(--primary-dark));color:#fff;cursor:pointer;}
.table-wrapper{overflow-x:auto;margin:20px;}
table{width:100%;border-collapse:collapse;background:var(--panel);border-radius:16px;overflow:hidden;box-shadow:0 10px 30px rgba(0,0,0,.5);}
th, td{padding:12px;text-align:left;border-bottom:1px solid var(--border);}
th{background:linear-gradient(135deg,var(--primary),var(--primary-dark));color:#fff;}
tr:hover{background:rgba(255,255,255,.05);}
</style>
</head>
<body>
<div class="header">
  <h1>Painel Admin</h1>
  <button class="button-logout" id="btnLogout">Sair</button>
</div>
<div class="table-wrapper">
  <table>
    <thead>
      <tr>
        <th>E-mail</th>
        <th>UID</th>
        <th>Provedores</th>
        <th>Criação</th>
        <th>Último Login</th>
      </tr>
    </thead>
    <tbody id="tabelaUsuarios"></tbody>
  </table>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js";
import { getFunctions, httpsCallable } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-functions.js";

const firebaseConfig = {
  apiKey: "SUA_API_KEY",
  authDomain: "SEU_PROJECT_ID.firebaseapp.com",
  projectId: "SEU_PROJECT_ID"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const functions = getFunctions(app);

const $ = (id)=>document.getElementById(id);

onAuthStateChanged(auth, async (user)=>{
  if(!user){
    window.location.href = "login.html";
  } else {
    carregarUsuarios();
  }
});

$("btnLogout").onclick = async ()=>{
  await signOut(auth);
  window.location.href = "login.html";
};

async function carregarUsuarios(){
  try{
    const listUsersCall = httpsCallable(functions, "listUsers");
    const result = await listUsersCall();
    const tbody = $("tabelaUsuarios");
    tbody.innerHTML = "";
    result.data.forEach(u=>{
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${u.email || ""}</td>
        <td>${u.uid}</td>
        <td>${u.providers}</td>
        <td>${u.createdAt}</td>
        <td>${u.lastLogin}</td>
      `;
      tbody.appendChild(tr);
    });
  } catch(e){
    console.error(e);
    alert("Erro ao carregar usuários. Verifique a função no Firebase.");
  }
}
</script>
</body>
</html>
